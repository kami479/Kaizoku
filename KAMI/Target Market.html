<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TARGERT MARKET PROFILE</title>
	<link rel="icon" type="image/x-icon" href="BUSINESS SUCCESS ANALYSIS.ico">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
    font-family: Arial, sans-serif;
            background-image: url("R4.jpg");
            background-size: 105%;
}

#fetch-button {
    margin: 20px;
    padding: 10px 20px;
    font-size: 16px;
}

#checkbox-container {
    margin: 20px;
}
.header {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 10px;
            text-align: center;
        }
        .content {
            font-size: 16px;
            line-height: 1.5;
            background-color: rgba(255, 255, 255, 0.0);
            border-radius: 9px;
			text-align: Center;
        }
h2 {
    margin-bottom: 10px;
    font-size: 1.5em;
	text-align: center;
}
/* Style for the outer table */
.checkbox-table {
    position: relative;
    border-collapse: collapse;
    width: 40%; /* Adjust the width as needed */
    margin: 10px auto; /* Center the table horizontally */
    font-family: Arial, sans-serif;
    font-size: 14px;
}

/* Style for table headers */
.checkbox-table th {
    border: 1px solid #ddd;
    padding: 8px;
    text-align: left;
    background-color: #00bcd4; /* Cyan background color for headers */
    color: #fff; /* White text color for better contrast */
    font-weight: bold; /* Make header text bold */
}

/* Style for table cells */
.checkbox-table td {
    border: 1px solid #ddd;
    padding: 8px;
    text-align: left;
    background-color: #f2f2f2; /* Background color for cells */
}

/* Style for nested tables */
.checkbox-table table {
    margin-top: 10px;
    border-collapse: collapse;
    width: 100%;
}

/* Style for nested table cells */
.checkbox-table td {
    border: 1px solid #ddd;
    padding: 5px;
}

/* Style for checkboxes and labels */
.checkbox-table input[type="checkbox"] {
    margin-right: 8px;
}

/* Style for table rows with alternating background colors */
.checkbox-table tr:nth-child(even) {
    background-color: #f9f9f9;
}

/* Hover effect for table rows */
.checkbox-table tr:hover {
    background-color: #e0e0e0;
}

 button {   
            position: relative;
			border-radius: 30px;
            border-color: cyan;
			width:500px;
			height:200px;
			top:180px;
			right:-00px;
			text-align:center;
			background-color: rgba(255, 255, 255, 0.3);
			font-weight: bold;
			
        }
        button:hover {
            box-shadow: 0 0 10px white;
            transition: box-shadow 0.3s ease;
        }

textarea {
            position: relative;
			border-radius: 9px;
            border-color: cyan;
			width:490px;
			height:40px;
			top:20px;
			right:-420px;
			text-align:center;
			background-color: rgba(255, 255, 255, 0.3);
			font-weight: bold;
			overflow-y: auto;
            resize: none;
            padding: 10px;
            box-sizing: border-box;
			border-radius:10px;
        }

    </style>
</head>
<body>
         <textarea id="search" name="search" rows="4" placeholder="search area" oninput="adjustHeight(this)"></textarea><br><br>
		 <i class="fas fa-search" style="position: absolute; top: -34.5px; right: -430px; color: black; font-size: 25px; position: relative;"></i>
		 <i class="fas fa-play-circle" style="position: absolute; top: -34.5px; right: -848px; color: black; font-size: 25px; position: relative;"></i>

		 
         <div class="content" id="checkbox-container">
		 <button id="fetch-button">
		 <i class="fas fa-briefcase arrow-icon" style="color: black; font-size: 120px;"></i><br><br>
		 LOAD AREA DATA
		 </button>
		 </div>


    <!-- Import Firebase SDK -->
<script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.1.3/firebase-app.js";
        import { getDatabase, ref, get } from "https://www.gstatic.com/firebasejs/9.1.3/firebase-database.js";

        // Your web app's Firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyCEc0UNL5rNGGSC9gvFkp08tLauRZ1bB5A",
    authDomain: "kami-ec8a4.firebaseapp.com",
    projectId: "kami-ec8a4",
    storageBucket: "kami-ec8a4.appspot.com",
    messagingSenderId: "659804249589",
    appId: "1:659804249589:web:f7f5c0e14a10f2c93894bc"
  };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

// Create a table row with a checkbox and label
function createCheckboxTableRow(key, value) {
    const row = document.createElement('tr');
    
    const cell = document.createElement('td');
    const checkbox = document.createElement('input');
    checkbox.type = 'checkbox';
    checkbox.id = key;
    checkbox.name = key;
    
    const label = document.createElement('label');
    label.htmlFor = checkbox.id;
    label.textContent = `${key}: ${value}`;
    
    cell.appendChild(checkbox);
    cell.appendChild(label);
    row.appendChild(cell);
    
    return row;
}

// Recursive function to create a table for deeply nested data
function createCheckboxTable(data, table) {
    const tbody = document.createElement('tbody');

    Object.keys(data).forEach(key => {
        const value = data[key];
        const row = document.createElement('tr');

        if (typeof value === 'object' && !Array.isArray(value)) {
            // Create a row for the parent key
            const cell = document.createElement('td');
            cell.colSpan = 2;
            cell.textContent = key;
            row.appendChild(cell);
            tbody.appendChild(row);

            // Create a nested table for the child data
            const nestedTable = document.createElement('table');
            nestedTable.className = 'checkbox-table';
            const nestedTbody = document.createElement('tbody');
            nestedTable.appendChild(nestedTbody);
            tbody.appendChild(nestedTable);

            createCheckboxTable(value, nestedTable);
        } else {
            // Create a row for the actual checkbox and label
            tbody.appendChild(createCheckboxTableRow(key, value));
        }
    });

    table.appendChild(tbody);
}

// Function to display data as a hierarchical table
function displayAreaData(data) {
    const container = document.getElementById('checkbox-container');
    container.innerHTML = '';  // Clear the container before adding new data

    Object.keys(data).forEach(areaName => {
        const areaData = data[areaName];
        
        const areaContainer = document.createElement('div');
        areaContainer.className = 'area-container';

        const areaTitle = document.createElement('h2');
        areaTitle.textContent = areaName;
        areaContainer.appendChild(areaTitle);

        // Create a table for the area data
        const table = document.createElement('table');
        table.className = 'checkbox-table';

        const thead = document.createElement('thead');
        const headerRow = document.createElement('tr');
        const headerTitle = document.createElement('th');
        headerRow.appendChild(headerTitle);
        thead.appendChild(headerRow);
        table.appendChild(thead);

        createCheckboxTable(areaData, table);

        areaContainer.appendChild(table);
        container.appendChild(areaContainer);
    });
}

// Function to fetch data from Firebase
async function fetchDataFromFirebase() {
    try {
        const dbRef = ref(database, '/');
        const snapshot = await get(dbRef);
        if (snapshot.exists()) {
            return snapshot.val();
        } else {
            console.log("No data available");
            return null;
        }
    } catch (error) {
        console.error('Error loading data from Firebase:', error);
        return null;
    }
}

// Function to search for the area and display the results
async function searchAndDisplayArea() {
    const searchQuery = document.getElementById('search').value.trim().toLowerCase();
    if (!searchQuery) {
        alert('Please enter an area name to search.');
        return;
    }

    const data = await fetchDataFromFirebase();
    if (data) {
        // Check for an exact match of the area name
        const matchingAreas = Object.keys(data).filter(areaName => areaName.toLowerCase() === searchQuery);
        if (matchingAreas.length > 0) {
            const areaName = matchingAreas[0]; // Assuming you want the first match
            displayAreaData({ [areaName]: data[areaName] });
            alert(`Area found: ${areaName}`);
        } else {
            alert('No matching area found.');
            document.getElementById('fetch-button').style.display = '';  // Clear container if no match
        }
    }
}

// Add event listener to the button with id "fetch-button" to trigger search
document.getElementById('fetch-button').addEventListener('click', searchAndDisplayArea);

// Adjust the height of the textarea
function adjustHeight(textarea) {
    textarea.style.height = 'auto';
    textarea.style.height = (textarea.scrollHeight) + 'px';
}

    </script>
</body>
</html>
